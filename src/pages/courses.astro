---
import MainLayout from '../layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import { marked } from 'marked';

// Get all courses
const courses = await getCollection('courses');

// Sort courses by code
courses.sort((a, b) => a.data.code.localeCompare(b.data.code));

// Function to render markdown
function renderMarkdown(content) {
  return marked.parse(content);
}
---

<MainLayout title="Courses - TABILAB">
  <div class="container mx-auto px-4 py-12">
    <h1 class="text-4xl font-bold text-primary mb-12 text-center">Courses</h1>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      {courses.map(course => (
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
          <div class="p-6">
            <div class="flex justify-between items-start mb-2">
              <h3 class="text-xl font-semibold text-primary">
                <a href={`/courses/${course.slug}`} class="hover:underline">
                  {course.data.title}
                </a>
              </h3>
              <span class="bg-primary text-white px-3 py-1 rounded-md text-sm">
                {course.data.code}
              </span>
            </div>
            
            <p class="text-gray-600 mb-2">Instructor: {course.data.instructor}</p>
            <p class="text-gray-600 mb-4">Semester: {course.data.semester} | Credits: {course.data.credits}</p>
            
            <div class="mb-4">
              <p class="text-gray-700">{course.data.description}</p>
            </div>
            
            <div class="flex flex-wrap gap-4">
              {course.data.syllabus && (
                <a 
                  href={course.data.syllabus} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="inline-flex items-center text-primary-light hover:underline"
                >
                  <span>Syllabus</span>
                </a>
              )}
              
              {course.data.materials && (
                <a 
                  href={course.data.materials} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="inline-flex items-center text-primary-light hover:underline"
                >
                  <span>Course Materials</span>
                </a>
              )}
              
              <a 
                href={`/courses/${course.slug}`}
                class="inline-flex items-center text-primary-light hover:underline"
              >
                <span>Details</span>
              </a>
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</MainLayout>